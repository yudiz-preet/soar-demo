import React, { useState, useEffect } from "react";
import ReactApexChart from "react-apexcharts";
import { io } from "socket.io-client";

const socket = io('http://3.7.98.19:3100/');

const ApexDateWiseVulnerability = () => {
  const [seriesData, setSeriesData] = useState([]);
  const [labels, setLabels] = useState([]);

  useEffect(() => {
    socket.on("connect", () => {
      console.log(socket.id); // x8WIv7-mJelg7on_ALbx
    });
    
    socket.on("disconnect", () => {
      console.log(socket.id); // undefined
    });
  
    socket.on('testMessage', function(data, labelsValue){
      console.log('data1: ', data);
      console.log('labelsValue: ', labelsValue)
      setSeriesData(data || [])
      setLabels(labelsValue || [])
    })

      return () => {
        socket.off("connect", () => {
          console.log(socket.id); // x8WIv7-mJelg7on_ALbx
        });
        
        socket.off("disconnect", () => {
          console.log(socket.id); // undefined
        });
      
        socket.off('testMessage', function(data, labelsValue){
          console.log('data1: ', data);
          console.log('labelsValue: ', labelsValue)
          setSeriesData(data || [])
          setLabels(labelsValue || [])
        })
          
      }
  }, [])

const chartData = {
  series: [
    {
      name: "Chart-1",
      type: "line",
      data: [0, 15, 25, 20, 32, 27]
    },
    {
      name: "Chart-2",
      type: "line",
      data: [0, 32, 20, 40, 20, 30]
    },
    {
      name: "Chart-3",
      type: "line",
      data: [0, 38, 50, 10, 28, 43]
    }
  ],
  chart: {
    height: 100,
    type: 'line',     
  },
  colors: ['#00008b', '#00FFFF', '#FFA500'],
  dataLabels: {
    enabled: true,
    style: {
      fontSize: '14px',
      colors: undefined
  },
    background:{
      enabled: true,
      foreColor: '#fff',
      padding: 4,        
      borderRadius: 15,
    }
  },
  stroke: {
    curve: 'smooth'
  },
  animations: {
    enabled: true,
    easing: 'easeinout',
    speed: 0.5,
    animateGradually: {
        enabled: true,
        delay: 10000
    },
    dynamicAnimation: {
        enabled: true,
        speed: 10000
    }
}
}

  return (
    <div style={{height:'500px', width:'500px'}}>
      <ReactApexChart options={{...chartData, series: seriesData, labels}} series={seriesData} />
    </div>
  )
}

export default ApexDateWiseVulnerability